<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Palestinian Arabic Translator & TTS | مترجم ومحول النص إلى كلام</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .main-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .app-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            padding: 30px;
            height: fit-content;
        }

        .translator-container {
            background: linear-gradient(135deg, #2196F3 0%, #21CBF3 100%);
            color: white;
        }

        .translator-container .app-container {
            background: white;
            color: #333;
        }

        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.8rem;
        }

        h2 {
            color: #666;
            text-align: center;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .input-section {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
            font-size: 14px;
        }

        textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .english-input {
            direction: ltr;
            text-align: left;
        }

        .arabic-output, .arabic-input {
            direction: rtl;
            text-align: right;
        }

        .arabic-output {
            background-color: #f8f9fa;
        }

        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            cursor: pointer;
            transition: transform 0.2s ease, box-shadow 0.2s ease;
            font-weight: 600;
            margin: 5px;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .translator-container button {
            background: linear-gradient(135deg, #2196F3 0%, #21CBF3 100%);
        }

        .translator-container button:hover {
            box-shadow: 0 5px 15px rgba(33, 150, 243, 0.4);
        }

        .copy-btn {
            background: #4CAF50;
            font-size: 12px;
            padding: 6px 12px;
        }

        .copy-btn:hover {
            box-shadow: 0 5px 15px rgba(76, 175, 80, 0.4);
        }

        .controls {
            text-align: center;
            margin: 15px 0;
        }

        .loading {
            display: none;
            text-align: center;
            font-weight: 600;
            margin: 10px 0;
        }

        .tts-loading {
            color: #667eea;
        }

        .translator-loading {
            color: #2196F3;
        }

        .error {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            display: none;
            font-size: 14px;
        }

        audio {
            width: 100%;
            margin-top: 15px;
        }

        .rules-section {
            background: #f0f8ff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 15px;
        }

        @media (max-width: 1024px) {
            .main-container {
                grid-template-columns: 1fr;
                gap: 20px;
            }
        }

        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .language-toggle button {
            background: #667eea;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin: 0 2px;
        }
        
        .language-toggle button.active {
            background: #4CAF50;
        }
        
        .english-ui h2 {
            direction: ltr;
            text-align: left;
        }
        
        .english-ui label {
            direction: ltr;
            text-align: left;
        }
        
        .english-ui .controls {
            direction: ltr;
            text-align: left;
        }

        @media (max-width: 600px) {
            .app-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.4rem;
            }
            
            h2 {
                font-size: 1.2rem;
            }
            
            .language-toggle {
                top: 10px;
                right: 10px;
            }
        }
    </style>
</head>
<body>
    <!-- Language Toggle -->
    <div class="language-toggle">
        <button id="arabicBtn" class="active" onclick="setLanguage('ar')">عربي</button>
        <button id="englishBtn" onclick="setLanguage('en')">English</button>
    </div>
    
    <div class="main-container">
        <!-- English to Palestinian Translator -->
        <div class="translator-container">
            <div class="app-container">
                <h2>مترجم إنجليزي - فلسطيني</h2>
                
                <div class="rules-section">
                    <label for="translationRules">قواعد الترجمة (يمكن تعديلها):</label>
                    <textarea 
                        id="translationRules" 
                        dir="rtl"
                        style="height: 120px; font-size: 12px;"
                    >أنت مترجم خبير للهجة الفلسطينية/الأردنية العامية.

المهمة: ترجم النص الإنجليزي التالي إلى اللهجة الفلسطينية/الأردنية العامية مع الحركات.

قواعد إجبارية يجب اتباعها:
1. أضف الحركات المهمة التي تُظهر اللهجة الفلسطينية
2. استخدم كلمات عامية محلية: شو (what)، وين (where)، ليش (why)، هيك (like this)
3. استخدم تركيبات نحوية طبيعية: بدّي (I want)، عندي (I have)، بشوف (I see)
4. استخدم تعبيرات شائعة في فلسطين والأردن فقط
5. استخدم أسلوب اللهجة البيضاء
6. احتفظ بالمعنى الأصلي مع التكييف الثقافي للضفة الغربية

قواعد الكتابة الإجبارية:
- لا تستخدم كلمات إنجليزية مثل "هاي" أو "باي" أبداً
- كن رسمياً في الأسلوب
- لترجمة "he has" اكتب "عنده" وليس "عندو"
- استخدم العربية الفصحى كمرجع للكتابة
- لا تحوّل حرف الثاء إلى تاء أبداً! اكتب "كثير" وليس "كتير"
- اكتب "إنَّه" وليس "إنو"

المخرجات المطلوبة:
- النص المترجم فقط بدون أي تفسير أو إضافات
- التزم بجميع القواعد المذكورة أعلاه</textarea>
                </div>
                
                <div class="input-section">
                    <label for="englishInput">النص الإنجليزي:</label>
                    <textarea 
                        id="englishInput" 
                        class="english-input"
                        placeholder="Enter English text here..."
                    ></textarea>
                </div>
                
                <div class="controls">
                    <button id="translateBtn" onclick="translateText()">
                        🔄 ترجم إلى الفلسطينية
                    </button>
                </div>
                
                <div class="error" id="translatorErrorMsg"></div>
                <div class="loading translator-loading" id="translatorLoadingMsg">جاري الترجمة...</div>
                
                <div class="input-section">
                    <label for="arabicOutput">النص المترجم (الفلسطيني/الأردني):</label>
                    <textarea 
                        id="arabicOutput" 
                        class="arabic-output"
                        placeholder="الترجمة ستظهر هنا..."
                        readonly
                    ></textarea>
                    <div style="text-align: left; margin-top: 10px;">
                        <button class="copy-btn" onclick="copyTranslation()">
                            📋 نسخ النص
                        </button>
                        <button class="copy-btn" onclick="sendToTTS()">
                            ➡️ إرسال للتحويل
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Text to Speech App -->
        <div class="tts-container">
            <div class="app-container">
                <h2>محول النص إلى كلام</h2>
                <p style="text-align: center; color: #666; margin-bottom: 20px; font-size: 14px;">
                    حسين - أداء معلم - السعودية الشمالية
                </p>

                <div class="input-section">
                    <label for="textInput">النص المراد تحويله:</label>
                    <textarea 
                        id="textInput" 
                        class="arabic-input"
                        placeholder="اكتب هنا النص أو الصق النص المترجم..."
                    ></textarea>
                </div>
                
                <div class="controls">
                    <button id="generateBtn" onclick="generateSpeech()">
                        🔊 تحويل إلى كلام
                    </button>
                    <button id="showApiBtn" onclick="showAPIData()">
                        🔍 عرض بيانات API
                    </button>
                </div>
                
                <div class="error" id="ttsErrorMsg"></div>
                <div class="loading tts-loading" id="ttsLoadingMsg">جاري التحويل...</div>
                
                <div style="text-align: center;">
                    <audio id="audioPlayer" controls style="display: none;"></audio>
                </div>
            </div>
        </div>
    </div>

    <!-- API Data Modal -->
    <div id="apiDataModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000;">
        <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 30px; border-radius: 15px; max-width: 90%; max-height: 80%; overflow-y: auto;">
            <h3 style="margin-bottom: 20px; text-align: center;">بيانات API المتاحة</h3>
            <div id="apiDataContent"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="closeAPIData()">إغلاق</button>
            </div>
        </div>
    </div>

    <script>
        // Language system
        const translations = {
            ar: {
                translatorTitle: 'مترجم إنجليزي - فلسطيني',
                translationRulesLabel: 'قواعد الترجمة (يمكن تعديلها):',
                englishInputLabel: 'النص الإنجليزي:',
                englishInputPlaceholder: 'Enter English text here...',
                translateBtn: '🔄 ترجم إلى الفلسطينية',
                arabicOutputLabel: 'النص المترجم (الفلسطيني/الأردني):',
                arabicOutputPlaceholder: 'الترجمة ستظهر هنا...',
                copyBtn: '📋 نسخ النص',
                sendBtn: '➡️ إرسال للتحويل',
                ttsTitle: 'محول النص إلى كلام',
                ttsSubtitle: 'حسين - أداء معلم - السعودية الشمالية',
                textInputLabel: 'النص المراد تحويله:',
                textInputPlaceholder: 'اكتب هنا النص أو الصق النص المترجم...',
                generateBtn: '🔊 تحويل إلى كلام',
                showApiBtn: '🔍 عرض بيانات API',
                translatorLoading: 'جاري الترجمة...',
                ttsLoading: 'جاري التحويل...',
                apiModalTitle: 'بيانات API المتاحة',
                closeBtn: 'إغلاق'
            },
            en: {
                translatorTitle: 'English to Palestinian Arabic Translator',
                translationRulesLabel: 'Translation Rules (editable):',
                englishInputLabel: 'English Text:',
                englishInputPlaceholder: 'Enter English text here...',
                translateBtn: '🔄 Translate to Palestinian',
                arabicOutputLabel: 'Translated Text (Palestinian/Jordanian):',
                arabicOutputPlaceholder: 'Translation will appear here...',
                copyBtn: '📋 Copy Text',
                sendBtn: '➡️ Send to TTS',
                ttsTitle: 'Text to Speech Converter',
                ttsSubtitle: 'Hussein - Teacher Performance - Northern Saudi Arabia',
                textInputLabel: 'Text to Convert:',
                textInputPlaceholder: 'Type here or paste the translated text...',
                generateBtn: '🔊 Convert to Speech',
                showApiBtn: '🔍 Show API Data',
                translatorLoading: 'Translating...',
                ttsLoading: 'Converting...',
                apiModalTitle: 'Available API Data',
                closeBtn: 'Close'
            }
        };

        let currentLanguage = 'ar';

        function setLanguage(lang) {
            currentLanguage = lang;
            
            // Update button states
            document.getElementById('arabicBtn').classList.toggle('active', lang === 'ar');
            document.getElementById('englishBtn').classList.toggle('active', lang === 'en');
            
            // Update HTML direction and class
            document.documentElement.lang = lang;
            document.documentElement.dir = lang === 'ar' ? 'rtl' : 'ltr';
            document.body.classList.toggle('english-ui', lang === 'en');
            
            // Update all translatable text
            updateTexts();
        }

        function updateTexts() {
            const t = translations[currentLanguage];
            
            // Update translator section
            document.querySelector('.translator-container h2').textContent = t.translatorTitle;
            document.querySelector('label[for="translationRules"]').textContent = t.translationRulesLabel;
            document.querySelector('label[for="englishInput"]').textContent = t.englishInputLabel;
            document.getElementById('englishInput').placeholder = t.englishInputPlaceholder;
            document.getElementById('translateBtn').innerHTML = t.translateBtn;
            document.querySelector('label[for="arabicOutput"]').textContent = t.arabicOutputLabel;
            document.getElementById('arabicOutput').placeholder = t.arabicOutputPlaceholder;
            document.querySelector('.copy-btn:first-of-type').innerHTML = t.copyBtn;
            document.querySelector('.copy-btn:last-of-type').innerHTML = t.sendBtn;
            
            // Update TTS section
            document.querySelector('.tts-container h2').textContent = t.ttsTitle;
            document.querySelector('.tts-container p').textContent = t.ttsSubtitle;
            document.querySelector('label[for="textInput"]').textContent = t.textInputLabel;
            document.getElementById('textInput').placeholder = t.textInputPlaceholder;
            document.getElementById('generateBtn').innerHTML = t.generateBtn;
            document.getElementById('showApiBtn').innerHTML = t.showApiBtn;
            
            // Update loading messages
            document.getElementById('translatorLoadingMsg').textContent = t.translatorLoading;
            document.getElementById('ttsLoadingMsg').textContent = t.ttsLoading;
            
            // Update modal
            document.querySelector('#apiDataModal h3').textContent = t.apiModalTitle;
            document.querySelector('#apiDataModal button').textContent = t.closeBtn;
        }

        // API Keys
        const LAHAJATI_API_KEY = 'sk_eyJpdiI6ImhmRm42ekkxMW5mWkFLb0lKdVFPdXc9PSIsInZhbHVlIjoiMElLaVhrWTdnSU56UWdveEkxQ0VrM1RIRFZLbldrbHJVUkdVZEVoU0NwaTdSRTA2Sm54YUY3V0JxeGhwNDZZdSIsIm1hYyI6IjMyNjBjMDdhNDUzMTA4MmU3ZTc0YmE5NmZmNDUyYjJiMzYzYWQ0NmMxNjgyYWEzOTg3ZTFhNjgwNDdlNDE2MzkiLCJ0YWciOiIifQ==';
        const OPENAI_API_KEY = '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';
        const LAHAJATI_API_BASE_URL = 'https://lahajati.ai/api/v1';

        // Fixed TTS preferences for speed
        const TTS_PREFERENCES = {
            voice: 'l6ErPsa0knOuPHhg7QtW3zyr',
            performance: '1798',
            dialect: '5'
        };

        let availableVoices = [];
        let availableDialects = [];
        let availablePerformances = [];

        // Translation Functions
        async function translateText() {
            const englishInput = document.getElementById('englishInput');
            const translationRules = document.getElementById('translationRules');
            const arabicOutput = document.getElementById('arabicOutput');
            const translateBtn = document.getElementById('translateBtn');
            const loadingMsg = document.getElementById('translatorLoadingMsg');
            const errorMsg = document.getElementById('translatorErrorMsg');
            
            const englishText = englishInput.value.trim();
            const rules = translationRules.value.trim();
            
            if (!englishText) {
                showTranslatorError('يرجى إدخال النص الإنجليزي');
                return;
            }
            
            hideTranslatorError();
            loadingMsg.style.display = 'block';
            translateBtn.disabled = true;
            arabicOutput.value = '';
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${OPENAI_API_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: rules
                            },
                            {
                                role: 'user',
                                content: englishText
                            }
                        ],
                        max_tokens: 500,
                        temperature: 0.3
                    })
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`OpenAI Error ${response.status}: ${errorData.error?.message || 'Unknown error'}`);
                }
                
                const data = await response.json();
                const translatedText = data.choices[0]?.message?.content?.trim();
                
                if (translatedText) {
                    arabicOutput.value = translatedText;
                } else {
                    throw new Error('لم يتم الحصول على ترجمة');
                }
                
            } catch (error) {
                console.error('Translation error:', error);
                showTranslatorError(`خطأ في الترجمة: ${error.message}`);
            } finally {
                loadingMsg.style.display = 'none';
                translateBtn.disabled = false;
            }
        }

        function copyTranslation() {
            const arabicOutput = document.getElementById('arabicOutput');
            const text = arabicOutput.value;
            
            if (!text) {
                showTranslatorError('لا يوجد نص للنسخ');
                return;
            }
            
            navigator.clipboard.writeText(text).then(() => {
                const copyBtn = document.querySelector('.copy-btn');
                const originalText = copyBtn.textContent;
                copyBtn.textContent = '✅ تم النسخ!';
                
                setTimeout(() => {
                    copyBtn.textContent = originalText;
                }, 2000);
            }).catch(() => {
                showTranslatorError('فشل في نسخ النص');
            });
        }

        function sendToTTS() {
            const arabicOutput = document.getElementById('arabicOutput');
            const textInput = document.getElementById('textInput');
            const text = arabicOutput.value;
            
            if (!text) {
                showTranslatorError('لا يوجد نص للإرسال');
                return;
            }
            
            textInput.value = text;
            
            // Visual feedback
            const sendBtn = document.querySelector('.copy-btn:last-child');
            const originalText = sendBtn.textContent;
            sendBtn.textContent = '✅ تم الإرسال!';
            
            setTimeout(() => {
                sendBtn.textContent = originalText;
            }, 2000);
        }

        // TTS Functions
        async function generateSpeech() {
            const textInput = document.getElementById('textInput');
            const generateBtn = document.getElementById('generateBtn');
            const loadingMsg = document.getElementById('ttsLoadingMsg');
            const errorMsg = document.getElementById('ttsErrorMsg');
            const audioPlayer = document.getElementById('audioPlayer');
            
            const text = textInput.value.trim();
            
            if (!text) {
                showTTSError('يرجى إدخال النص المراد تحويله');
                return;
            }
            
            hideTTSError();
            audioPlayer.style.display = 'none';
            loadingMsg.style.display = 'block';
            generateBtn.disabled = true;
            
            try {
                const requestBody = {
                    text: text,
                    id_voice: TTS_PREFERENCES.voice,
                    input_mode: "0",
                    performance_id: TTS_PREFERENCES.performance,
                    dialect_id: TTS_PREFERENCES.dialect
                };
                
                const response = await fetch(`${LAHAJATI_API_BASE_URL}/text-to-speech-absolute-control`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${LAHAJATI_API_KEY}`,
                        'Content-Type': 'application/json',
                        'Accept': 'audio/mpeg'
                    },
                    body: JSON.stringify(requestBody)
                });
                
                if (!response.ok) {
                    const errorData = await response.json().catch(() => ({}));
                    throw new Error(`API Error ${response.status}: ${JSON.stringify(errorData)}`);
                }
                
                const audioBlob = await response.blob();
                
                if (audioBlob.size === 0) {
                    throw new Error('تم إرجاع ملف صوتي فارغ');
                }
                
                const audioUrl = URL.createObjectURL(audioBlob);
                audioPlayer.src = audioUrl;
                audioPlayer.style.display = 'block';
                
            } catch (error) {
                console.error('Error generating speech:', error);
                showTTSError(`خطأ في تحويل النص: ${error.message}`);
            } finally {
                loadingMsg.style.display = 'none';
                generateBtn.disabled = false;
            }
        }

        // API Data Functions
        async function loadAPIData() {
            try {
                // Load voices
                const voicesResponse = await fetch(`${LAHAJATI_API_BASE_URL}/voices-absolute-control`, {
                    headers: {
                        'Authorization': `Bearer ${LAHAJATI_API_KEY}`,
                        'Accept': 'application/json'
                    }
                });
                
                if (voicesResponse.ok) {
                    const voicesData = await voicesResponse.json();
                    availableVoices = voicesData.data || [];
                }

                // Load performances
                const performancesResponse = await fetch(`${LAHAJATI_API_BASE_URL}/performance-absolute-control`, {
                    headers: {
                        'Authorization': `Bearer ${LAHAJATI_API_KEY}`,
                        'Accept': 'application/json'
                    }
                });
                
                if (performancesResponse.ok) {
                    const performancesData = await performancesResponse.json();
                    availablePerformances = performancesData.data || [];
                }

                // Load dialects
                let allDialects = [];
                let page = 1;
                let hasMore = true;
                
                while (hasMore) {
                    const dialectsResponse = await fetch(`${LAHAJATI_API_BASE_URL}/dialect-absolute-control?page=${page}`, {
                        headers: {
                            'Authorization': `Bearer ${LAHAJATI_API_KEY}`,
                            'Accept': 'application/json'
                        }
                    });
                    
                    if (dialectsResponse.ok) {
                        const dialectsData = await dialectsResponse.json();
                        const pageDialects = dialectsData.data || [];
                        allDialects = allDialects.concat(pageDialects);
                        
                        hasMore = dialectsData.meta && dialectsData.meta.has_more_pages;
                        page++;
                        
                        if (page > 10) break;
                    } else {
                        hasMore = false;
                    }
                }
                
                availableDialects = allDialects;
                
            } catch (error) {
                console.error('Error loading API data:', error);
            }
        }

        function showAPIData() {
            const modal = document.getElementById('apiDataModal');
            const content = document.getElementById('apiDataContent');
            
            let html = '<div style="direction: rtl; text-align: right;">';
            
            // Current settings
            html += '<h4>الإعدادات الحالية:</h4>';
            html += `<p><strong>الصوت:</strong> حسين (${TTS_PREFERENCES.voice})</p>`;
            html += `<p><strong>الأداء:</strong> أداء معلم (${TTS_PREFERENCES.performance})</p>`;
            html += `<p><strong>اللهجة:</strong> السعودية الشمالية (${TTS_PREFERENCES.dialect})</p><br>`;
            
            // Voices section
            html += '<h4>جميع الأصوات المتاحة:</h4><ul>';
            availableVoices.forEach(voice => {
                const current = voice.id_voice === TTS_PREFERENCES.voice ? ' ← (الحالي)' : '';
                html += `<li><strong>${voice.display_name}</strong> - ID: ${voice.id_voice} (${voice.gender})${current}</li>`;
            });
            html += '</ul><br>';
            
            // Performances section
            html += '<h4>جميع أنماط الأداء المتاحة:</h4><ul>';
            availablePerformances.forEach(perf => {
                const perfId = perf.performance_id || perf.id;
                const current = perfId === TTS_PREFERENCES.performance ? ' ← (الحالي)' : '';
                html += `<li><strong>${perf.display_name || perf.name}</strong> - ID: ${perfId}${current}</li>`;
            });
            html += '</ul><br>';
            
            // Dialects section
            html += '<h4>جميع اللهجات المتاحة:</h4><ul>';
            availableDialects.forEach(dialect => {
                const dialectId = dialect.dialect_id || dialect.id;
                const current = dialectId.toString() === TTS_PREFERENCES.dialect ? ' ← (الحالي)' : '';
                html += `<li><strong>${dialect.display_name}</strong> - ID: ${dialectId}${current}</li>`;
            });
            html += '</ul>';
            
            html += '</div>';
            
            content.innerHTML = html;
            modal.style.display = 'block';
        }

        function closeAPIData() {
            document.getElementById('apiDataModal').style.display = 'none';
        }

        // Error handling functions
        function showTranslatorError(message) {
            const errorMsg = document.getElementById('translatorErrorMsg');
            errorMsg.textContent = message;
            errorMsg.style.display = 'block';
        }
        
        function hideTranslatorError() {
            const errorMsg = document.getElementById('translatorErrorMsg');
            errorMsg.style.display = 'none';
        }

        function showTTSError(message) {
            const errorMsg = document.getElementById('ttsErrorMsg');
            errorMsg.textContent = message;
            errorMsg.style.display = 'block';
        }
        
        function hideTTSError() {
            const errorMsg = document.getElementById('ttsErrorMsg');
            errorMsg.style.display = 'none';
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize UI language
            updateTexts();
            
            // Load API data in background for display purposes
            loadAPIData();
        });

        // Keyboard shortcuts
        document.getElementById('englishInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                translateText();
            }
        });

        document.getElementById('textInput').addEventListener('keydown', function(e) {
            if (e.ctrlKey && e.key === 'Enter') {
                generateSpeech();
            }
        });
    </script>
</body>
</html>